#/bin/bash

swapFile="/mnt/pagefile"
parameterFileDir="/var/local/makeswap-on-azure"
if [ -f "$swapFile" ]; then
    swapoff $swapFile
    if (($? == 0)); then
        echo "[makeswap-on-azure]: Swap file disabled." > /dev/kmsg
    else
        echo "[makeswap-on-azure]: Failed to disable swap file." > /dev/kmsg
    fi

    rm $swapFile
    if (($? == 0)); then
        echo "[makeswap-on-azure]: Swap file removed." > /dev/kmsg
    else
        echo "[makeswap-on-azure]: Failed to remove swap file." > /dev/kmsg
    fi
fi

if [ -d $parameterFileDir ]; then
    rm -rf $parameterFileDir
    if (($? == 0)); then
        echo "[makeswap-on-azure]: Parameter file directory removed." > /dev/kmsg
    else
        echo "[makeswap-on-azure]: Failed to remove parameter file directory." > /dev/kmsg
    fi
fi